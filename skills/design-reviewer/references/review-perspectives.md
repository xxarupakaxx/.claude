# レビュー観点 詳細

## 2.1 要件カバレッジ（requirements.md が必要）

- requirements.md の**各受入基準**がdesign.mdのどこでカバーされているか（1対1で対応付け）
- カバーされていない要件はないか
- 過剰な設計はないか（判断基準: requirements.md の要件・受入基準のいずれにも対応しない設計要素。ただし、要件を満たすために技術的に必要な基盤設計（エラーハンドリング共通化、DB接続管理等）は過剰設計に該当しない）
- 要件の意図が正しく設計に反映されているか（文言の一致ではなく意味の一致）

## 2.2 既存アーキテクチャ・制約との整合

- **依存境界**: 設計が既存のモジュール境界・レイヤー構成を守っているか
  - 例: backend → cms の直接参照、gateway を迂回するアクセスなど
- **既存方針**: プロジェクトで採用している設計方針（スキーマファースト、エラーハンドリング方針等）に沿っているか
- **採用技術スタック**: 使用するライブラリ・フレームワークがプロジェクトの技術スタックに含まれるか
  - 新規ライブラリ導入がある場合は明示的に指摘
- **ディレクトリ構成**: 新規ファイル・モジュールの配置が既存構成と整合しているか

## 2.3 既存システムとのインタフェース整合

- **契約（Contract）**: 設計で定義されたコンポーネント間のインタフェースが、既存システムのインタフェースと整合しているか
- **責務（Responsibility）**: 各コンポーネントに割り当てられた責務が、既存の責務分担パターンと矛盾しないか
- **データ定義**: 設計で想定するデータモデルが既存のデータ構造と整合しているか
  - データモデル変更がある場合、既存データとの互換性・移行方針が設計で考慮されているか
- **外部システム連携**: 外部システムとのインタフェース（入出力の形式、認証方式、呼び出し順序等）が設計上正しく定義されているか

## 2.4 スコープ境界と非機能要件

- **スコープ境界**: 設計のスコープが明確か。何をやり、何をやらないかが定義されているか
- **非機能要件の網羅性**: パフォーマンス、セキュリティ、可用性、監視等の非機能要件が考慮されているか
  - requirements.md で言及されている非機能要件がすべて設計に反映されているか
- **状態遷移**: ステートフルな処理がある場合、状態遷移が明確に定義されているか
  - 遷移条件、各状態でのガード条件、不正遷移の防止が考慮されているか
- **べき等性**: バッチ処理・イベント処理がある場合、再実行時の安全性が設計されているか

## 2.5 未決定事項・考慮漏れの抽出

**設計判断（Step 5の「設計判断」セクション）とは異なる観点**。トレードオフの選択ではなく、**そもそも検討されていない事項**を抽出する:

- 設計で言及されていないが、requirements.md に含まれる要件はないか
- 設計で暗黙的に前提としているが、明文化されていない前提条件はないか
- エッジケース・異常系で検討が不足している箇所はないか
- 運用面（デプロイ手順、フィーチャーフラグ、ロールバック方針等）の考慮が必要ないか
- データの初期化・マイグレーション・既存データの扱いが未定義でないか

## 2.6 設計の前提の正しさ

以下の観点で確認する（具体的な検証手順は `references/verification-steps.md` を参照）:

- design.md が前提としている既存コンポーネント・モジュールが実在するか
- 設計で参照されているインタフェースや振る舞いが、実際の既存システムと一致するか
- 設計で想定したモジュール配置が既存のディレクトリ構成・命名規則に沿っているか

## 2.7 技術的実現可能性

- 設計で提案されたアプローチが、採用技術スタックの制約内で実現可能か
- 依存する外部ライブラリ・サービスが利用可能か
- 設計上のデータフローに矛盾がないか

## 2.8 エラーハンドリング・エッジケース

- 設計でエラーパスが網羅されているか
- フェイルオープン/フェイルクローズの戦略が設計レベルで明記されているか
- 境界値・異常系の考慮が設計に含まれているか

## 2.9 テスト戦略

- テスト戦略が要件をカバーしているか
- 設計がテスト容易性を考慮しているか（コンポーネント間の疎結合等）
- プロパティベーステストが適切に定義されているか（あれば）

## 2.10 パフォーマンス・スケーラビリティ

- パフォーマンス要件に対する設計が妥当か
- 設計上のデータアクセスパターンにパフォーマンスリスクがないか
- キャッシュ戦略・スケーリング方針が設計で考慮されているか（要件にあれば）

## 2.11 外部仕様との整合性（Confluence ページ取得時のみ）

- 外部仕様に記載された機能・画面・挙動が設計でカバーされているか
- 外部仕様と設計の間に矛盾がないか
- 外部仕様に記載されているが設計で言及されていない項目はないか
