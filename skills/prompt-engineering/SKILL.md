---
name: prompt-engineering
description: エージェント向けのコマンド、フック、スキル、サブエージェント向けプロンプト、その他LLMインタラクションを作成する際に使用。プロンプト最適化、LLM出力改善、本番用プロンプトテンプレート設計を含む。
---

# プロンプトエンジニアリングパターン

LLMのパフォーマンス、信頼性、制御性を最大化するための高度なプロンプトエンジニアリング技術。

## コア機能

1. **Few-Shot Learning** - 例を見せてモデルに教える（2-5個の入出力ペア）
2. **Chain-of-Thought** - ステップバイステップの推論を要求し精度を30-50%向上
3. **プロンプト最適化** - テストと改良を通じた体系的な改善サイクル
4. **テンプレートシステム** - 変数・条件付きセクションを持つ再利用可能な構造
5. **システムプロンプト設計** - 会話全体で持続するグローバルな動作と制約の設定

詳細と例は `Read references/core-techniques.md` を参照。

## キーパターン

### 段階的開示

シンプルなプロンプトから始め、必要な場合にのみ複雑さを追加:

1. **レベル1**: 直接的な指示
   - 「この記事を要約して」

2. **レベル2**: 制約を追加
   - 「この記事を3つの箇条書きで要約し、主要な発見に焦点を当てて」

3. **レベル3**: 推論を追加
   - 「この記事を読み、主要な発見を特定し、3つの箇条書きで要約して」

4. **レベル4**: 例を追加
   - 入出力ペアを含む2-3個のサンプル要約を含める

### 指示階層

```
[システムコンテキスト] → [タスク指示] → [例] → [入力データ] → [出力フォーマット]
```

### エラー回復

失敗を優雅に処理するプロンプトを構築:

- フォールバック指示を含める
- 信頼度スコアを要求
- 不確実な場合は代替解釈を求める
- 情報が不足している場合の示し方を指定

## ベストプラクティス

1. **具体的に**: 曖昧なプロンプトは一貫性のない結果を生む
2. **説明より例示**: 説明より例の方が効果的
3. **広範にテスト**: 多様で代表的な入力で評価
4. **迅速に反復**: 小さな変更が大きな影響を与える可能性がある
5. **パフォーマンス監視**: 本番でメトリクスを追跡
6. **バージョン管理**: プロンプトを適切なバージョン管理でコードとして扱う
7. **意図を文書化**: プロンプトがそのように構造化されている理由を説明

## 一般的な落とし穴

- **過剰エンジニアリング**: シンプルなものを試す前に複雑なプロンプトから始める
- **例の汚染**: ターゲットタスクに一致しない例を使用
- **コンテキストオーバーフロー**: 過度な例でトークン制限を超える
- **曖昧な指示**: 複数の解釈の余地を残す
- **エッジケースの無視**: 異常または境界入力でテストしない

## エージェントプロンプティング

Anthropic公式のベストプラクティスに基づく、エージェント向けプロンプト設計の原則集。コンテキストウィンドウ管理、簡潔さの原則、自由度設定、7つの説得原則（権威・コミットメント・希少性・社会的証明・一体感・互恵性・好意）を含む。

詳細は `Read references/agent-prompting.md` を参照。
