---
globs: ["**/migrations/**", "**/schema/**", "**/drizzle/**", "**/prisma/**"]
---

# Database Rules

データベース関連ファイル編集時に適用されるルール。

## マイグレーション

- マイグレーションファイル名は日時プレフィックス付き（例: `20260208_add_users_table`）
- 既存マイグレーションファイルは絶対に変更しない
- ロールバック可能な変更を心がける
- 破壊的変更（カラム削除等）は段階的に実施

## スキーマ設計

- テーブル名は複数形スネークケース（例: `users`, `order_items`）
- カラム名はスネークケース（例: `created_at`, `user_id`）
- 外部キーには`_id`サフィックス
- `created_at`と`updated_at`は全テーブルに付与

## パフォーマンス

- N+1クエリを避ける（eager loadingを使用）
- 頻繁に検索されるカラムにはインデックスを付与
- 大量データの取得時はページネーションを使用
