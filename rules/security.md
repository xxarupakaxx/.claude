---
globs: ["**/auth/**", "**/api/**", "**/middleware/**", "**/routes/**"]
---

# Security Rules

認証・API関連ファイル編集時に適用されるルール。

## 認証・認可

- 認証が必要なエンドポイントには必ずミドルウェアを適用
- 認可チェックはリソースアクセス前に実施
- セッション/トークンの有効期限を適切に設定
- パスワードは必ずハッシュ化して保存

## 入力検証

- すべてのユーザー入力をサニタイズ
- SQLクエリにはパラメータバインディングを使用
- HTMLエスケープでXSSを防止
- ファイルアップロードは拡張子・MIMEタイプを検証

## 機密情報

- APIキー・シークレットをコードにハードコードしない
- 環境変数を使用し、.envはgitignore
- ログに機密情報を出力しない
- エラーメッセージで内部情報を露出しない

## OWASP Top 10

編集時は以下を意識:
- インジェクション対策
- 認証の破綻防止
- 機密データの保護
- アクセス制御の実装
